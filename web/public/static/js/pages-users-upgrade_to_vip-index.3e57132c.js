(self["webpackChunkcmi_uni_app"]=self["webpackChunkcmi_uni_app"]||[]).push([[192],{34635:function(t,e,a){var n=a(81295);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);var i=a(69333).A;i("b0cab252",n,!0,{sourceMap:!1,shadowMode:!1})},96574:function(t,e,a){var n=a(12722);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);var i=a(69333).A;i("4e4bcaba",n,!0,{sourceMap:!1,shadowMode:!1})},77937:function(t,e,a){"use strict";var n;a.d(e,{A:function(){return p}});var i,o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"payment",class:t.showPaymentWidget?"on":""},[a("v-uni-view",{staticClass:"title acea-row row-center-wrapper"},[t._v("选择付款方式"),a("v-uni-text",{staticClass:"iconfont icon-guanbi",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.emitClose.apply(void 0,arguments)}}})],1),t._l(t.payModesToSelect,(function(e){return a("v-uni-view",{key:e.value,staticClass:"item acea-row row-between-wrapper",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.goPay(e)}}},[a("v-uni-view",{staticClass:"left acea-row row-between-wrapper"},[a("v-uni-view",{staticClass:"iconfont",class:e.icon}),a("v-uni-view",{staticClass:"text"},[a("v-uni-view",{staticClass:"name"},[t._v(t._s(e.name))]),e.number?a("v-uni-view",{staticClass:"info"},[t._v(t._s(e.title)),a("span",{staticClass:"money"},[t._v("￥"+t._s(e.number))])]):a("v-uni-view",{staticClass:"info"},[t._v(t._s(e.title))])],1)],1),a("v-uni-view",{staticClass:"iconfont icon-xiangyou"})],1)}))],2),t.showPaymentWidget?a("v-uni-view",{ref:"close",staticClass:"mask",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.emitClose.apply(void 0,arguments)}}}):t._e()],1)},s=[],r=(a(28706),a(2008),a(50113),a(74423),a(62062),a(26099),a(78459),a(21699),a(40658)),c={props:{enabledPayModes:{type:Array,default:function(){return[]}},showPaymentWidget:{type:Boolean,default:!1}},data:function(){return{userBalance:0}},computed:{payModesToSelect:function(t){var e=t.enabledPayModes,a=t.userBalance,n=[{name:"微信支付",icon:"icon-weixinzhifu",value:"wechat",title:"微信快捷支付",payStatus:1},{name:"支付宝支付",icon:"icon-zhifubao",value:"alipay",title:"支付宝支付",payStatus:this.$store.getters.globalData.alipay_open},{name:"余额支付",icon:"icon-yuezhifu",value:"balance",title:"可用余额:",number:a,payStatus:this.$store.getters.globalData.yue_pay_status}];return e.map((function(t){return n.find((function(e){return e.value===t}))})).filter((function(t){return!!t}))}},watch:{showPaymentWidget:function(t){t&&this.enabledPayModes.includes("balance")&&this.refreshUserBalance()}},methods:{refreshUserBalance:function(){var t=this;return(0,r.ug)().then((function(e){t.userBalance=e.data.now_money}))},emitClose:function(){this.$emit("close")},goPay:function(t){var e=this.getType(t.value);this.$emit("prepareToPay",{payType:e,payMode:t})},getType:function(t){var e=t;return"wechat"==t?e=this.$wechat.isWeixin()?"weixin":"h5":"alipay"==t&&(e="alipay"),e},pay:function(t){var e=t.payMode,a=t.paymentAmount,n=t.createOrderPromiseFn,i=t.success,o=void 0===i?function(){}:i,s=t.fail,r=void 0===s?function(){}:s,c=this.$util,l=this.$wechat,u=this.emitClose,d=e.number||0,p=e.value,f=this.getType(p),v=function(t){console.log("pay success: ",t),uni.hideLoading(),u(),c.Tips({title:"支付成功",icon:"success"}),setTimeout(o,1500)},m=function(t,e){return console.log("pay fail: ",t),uni.hideLoading(),r(t),u(),c.Tips({title:e?"取消支付":"支付失败"})};if("balance"==f&&parseFloat(d)<parseFloat(a))return c.Tips({title:"余额不足！"});uni.showLoading({title:"支付中"}),n().then((function(t){console.log("create order: ",t);var e=t.data.status,a=t.data.result.order_id,n=t.data.result.config,i=t.data.result.pay_key;switch(e){case"ORDER_EXIST":case"EXTEND_ORDER":case"PAY_ERROR":case"error":return uni.hideLoading(),r(t),u(),c.Tips({title:t.message});case"success":return v();case"alipay":case"alipayQr":return uni.hideLoading(),u(),uni.navigateTo({url:"/pages/order_pay_back/index?keyCode="+i+"&url="+n});case"wechat":case"weixin":case"weixinApp":n.timeStamp=n.timestamp,l.pay(n).then((function(t){v(t)})).catch((function(t){var e="chooseWXPay:cancel"==t.errMsg;m(t,e)}));break;case"balance":return uni.hideLoading(),u(),c.Tips({title:t.message});case"h5":var o=window.location.protocol+"//"+window.location.host,s="".concat(o,"/pages/order_pay_status/index?order_id=").concat(a),d=encodeURIComponent(s),p=n.mweb_url||n.h5_url,f="".concat(p,"&redirect_url=").concat(d);setTimeout((function(){location.href=f}),100);break}})).catch((function(t){return uni.hideLoading(),c.Tips({title:t})}))}}},l=c,u=(a(34635),a(18535)),d=(0,u.A)(l,o,s,!1,null,"40f2aa31",null,!1,n,i),p=d.exports},70118:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return p}});var n,i={cPage:a(49752).A,commonPayment:a(77937).A},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("c-page",{attrs:{"login-required":!0,"bg-theme":"none"},on:{ready:function(e){arguments[0]=e=t.$handleEvent(e),t.onPageReady.apply(void 0,arguments)}}},[t.vipProduct&&t.vipProduct.def?a("v-uni-view",{staticStyle:{"padding-bottom":"180rpx"}},[t._l(t.vipProduct.def.posters,(function(t){return a("v-uni-image",{key:t,staticClass:"w-full block",attrs:{src:t,mode:"widthFix"}})})),a("v-uni-view",{staticClass:"px-24 py-12 flex align-items-center fixed left-0 bottom-0 w-full bg-white"},[a("v-uni-view",{staticClass:"flex-auto"},[a("v-uni-view",{staticClass:"golden fs-24 font-bold"},[t._v("¥ "+t._s(t.vipProduct.def.price))]),a("v-uni-view",{staticClass:"fs-12"},[a("v-uni-view",{staticClass:"inline-block",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.agree=!t.agree}}},[a("v-uni-checkbox",{staticClass:"events-disabled",attrs:{checked:t.agree}}),t._v("已阅读并同意")],1),a("v-uni-navigator",{staticClass:"golden inline-block",attrs:{url:"/pages/users/privacy/index?type=sys_svip"}},[t._v("《会员协议》")])],1)],1),a("v-uni-button",{staticClass:"cmi-btn cmi-btn-sm buy-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.buyNow.apply(void 0,arguments)}}},[t._v("立即升级")])],1)],2):t._e(),a("common-payment",{ref:"payment",attrs:{enabledPayModes:["wechat"],showPaymentWidget:t.showPaymentWidget},on:{prepareToPay:function(e){arguments[0]=e=t.$handleEvent(e),t.prepareToPay.apply(void 0,arguments)},close:function(e){arguments[0]=e=t.$handleEvent(e),t.showPaymentWidget=!1}}})],1)},s=[],r=a(40658),c={data:function(){return{vipProduct:null,agree:!1,showPaymentWidget:!1}},methods:{onPageReady:function(){var t=this;(0,r.TR)().then((function(e){console.log(e),t.vipProduct=e.data}))},buyNow:function(){var t=this;if(!this.agree)return uni.showModal({title:"请确认会员条款",content:"已阅读并同意《会员协议》",success:function(e){e.confirm&&(t.agree=!0,t.showPaymentWidget=!0)}});this.showPaymentWidget=!0},prepareToPay:function(t){var e=t.payType,a=t.payMode,n=this.vipProduct.def;this.$refs.payment.pay({payMode:a,paymentAmount:n.price,createOrderPromiseFn:function(){return(0,r.h)(n.group_data_id,{pay_type:e,return_url:location.origin+"/pages/user/index"})},success:function(){uni.navigateBack()},fail:function(){}})}}},l=c,u=(a(96574),a(18535)),d=(0,u.A)(l,o,s,!1,null,"46d951e6",null,!1,i,n),p=d.exports},81295:function(t,e,a){"use strict";a.r(e);var n=a(45522),i=a.n(n),o=a(67643),s=a.n(o),r=s()(i());r.push([t.id,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.payment[data-v-40f2aa31]{position:fixed;bottom:0;left:0;width:100%;max-height:%?600?%;border-radius:%?16?% %?16?% 0 0;background-color:#fff;padding-bottom:%?60?%;z-index:99;transition:all .3s cubic-bezier(.25,.5,.5,.9);-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}.payment.on[data-v-40f2aa31]{-webkit-transform:translateZ(0);transform:translateZ(0)}.payment .title[data-v-40f2aa31]{text-align:center;height:%?123?%;font-size:%?32?%;color:#282828;font-weight:700;padding-right:%?30?%;margin-left:%?30?%;position:relative;border-bottom:1px solid #eee}.payment .title .iconfont[data-v-40f2aa31]{position:absolute;right:%?30?%;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);font-size:%?43?%;color:#8a8a8a;font-weight:400}.payment .item[data-v-40f2aa31]{border-bottom:1px solid #eee;height:%?130?%;margin-left:%?30?%;padding-right:%?30?%}.payment .item .left[data-v-40f2aa31]{width:%?610?%}.payment .item .left .text[data-v-40f2aa31]{width:%?540?%}.payment .item .left .text .name[data-v-40f2aa31]{font-size:%?32?%;color:#282828}.payment .item .left .text .info[data-v-40f2aa31]{font-size:%?24?%;color:#999}.payment .item .left .text .info .money[data-v-40f2aa31]{color:#f90}.payment .item .left .iconfont[data-v-40f2aa31]{font-size:%?45?%;color:#09bb07}.payment .item .left .iconfont.icon-zhifubao[data-v-40f2aa31]{color:#00aaea}.payment .item .left .iconfont.icon-yuezhifu[data-v-40f2aa31]{color:#f90}.payment .item .left .iconfont.icon-yuezhifu1[data-v-40f2aa31]{color:#eb6623}.payment .item .iconfont[data-v-40f2aa31]{font-size:%?0.3?%;color:#999}',""]),e["default"]=r},12722:function(t,e,a){"use strict";a.r(e);var n=a(45522),i=a.n(n),o=a(67643),s=a.n(o),r=s()(i());r.push([t.id,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.golden[data-v-46d951e6]{color:#f3b33d}.buy-button[data-v-46d951e6]{color:#fff;background:linear-gradient(97.29deg,#ffd177 5.67%,#f3b33d 94.33%);padding-left:%?80?%;padding-right:%?80?%}',""]),e["default"]=r}}]);